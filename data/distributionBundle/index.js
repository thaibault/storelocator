'use strict';if(typeof module!=='undefined'&&module!==null&&eval('typeof require')!=='undefined'&&eval('require')!==null&&'main'in eval('require')&&eval('typeof require.main')!=='undefined'&&eval('require.main')!==null){var ORIGINAL_MAIN_MODULE=module;if(module!==eval('require.main')&&'paths'in module&&'paths'in eval('require.main')&&typeof __dirname!=='undefined'&&__dirname!==null)module.paths=eval('require.main.paths').concat(module.paths.filter(function(path){return eval('require.main.paths').includes(path)}))};if(typeof window==='undefined'||window===null)var window=(typeof global==='undefined'||global===null)?{}:global;!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("clientnode"),require("clientnode/property-types"),require("@googlemaps/markerclustererplus"),require("web-component-wrapper/decorator"),require("web-component-wrapper/Web"));else if("function"==typeof define&&define.amd)define(["clientnode","clientnode/property-types","@googlemaps/markerclustererplus","web-component-wrapper/decorator","web-component-wrapper/Web"],t);else{var n="object"==typeof exports?t(require("clientnode"),require("clientnode/property-types"),require("@googlemaps/markerclustererplus"),require("web-component-wrapper/decorator"),require("web-component-wrapper/Web")):t(e.clientnode,e["clientnode/property-types"],e["@googlemaps/markerclustererplus"],e["web-component-wrapper/decorator"],e["web-component-wrapper/Web"]);for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(this,(function(e,t,n,i,o){return function(){"use strict";var r=[,function(t){t.exports=e},function(e){e.exports=t},function(e){e.exports=n},function(e){e.exports=i},function(e){e.exports=o}],s={};function a(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return r[e](n,n.exports,a),n.exports}a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return function(){a.r(l),a.d(l,{StoreLocator:function(){return O},api:function(){return T}});var e,t,n,i,o,r,s,u,c,d,h,p,f,m,g=a(1),v=a.n(g),y=a(2),C=a(3),b=a.n(C),w=a(4),k=a.n(w),x=a(5),S=a.n(x);function L(){return L=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},L.apply(this,arguments)}function R(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function W(e,t,n,i,o,r,s){try{var a=e[r](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(i,o)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){function r(e){W(a,i,o,r,s,"next",e)}function s(e){W(a,i,o,r,s,"throw",e)}var a=e.apply(t,n);r(void 0)}))}}function I(e,t,n,i){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function P(e,t){for(var n,i=0;i<t.length;i++)(n=t[i]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function z(e,t,n,i,o){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var O=(e=k()({type:y.object}),t=k()(),n=k()({type:y.any}),i=k()({type:y.boolean,writeAttribute:!0}),o=k()({type:y.boolean,writeAttribute:!0}),r=k()({type:y.any}),m=function(e){var t=Number.MAX_VALUE;function n(){var t;return(t=e.call(this)||this).initialized=!1,t.loaded=!1,I(t,"configuration",u,A(t)),t.resolvedConfiguration={},t.urlConfiguration=null,t.filter=function(){return!0},t.items=[],t.searchResultsStyleProperties={},t.seenLocations=[],t.transform=v().identity,t.highlightedItem=null,t.openWindow=null,t.searchBoxInitialized=!1,t.searchResultRange=null,t.searchResults=[],t.searchSegments=[],t.searchText=null,t.searchWords=[],t.searchResultsDirty=!1,I(t,"name",c,A(t)),I(t,"default",d,A(t)),t.dirty=!1,I(t,"disabled",h,A(t)),t.invalid=!1,t.pristine=!0,I(t,"required",p,A(t)),t.valid=!0,I(t,"value",f,A(t)),t.map=null,t.markerClusterer=null,t.resetMarkerCluster=null,t.self=n,t.lock=new g.Lock,t.onMapCenterChanged=function(){t.searchText&&t.slots.searchResults&&(t.searchResultsDirty=!0)},t.onInputClick=function(){t.searchText&&t.openSearchResults()},t.onInputFocus=function(){t.searchText&&t.openSearchResults()},t.onInputKeyDown=function(e){v().keyCode.DOWN===e.keyCode&&t.searchText&&t.openSearchResults()},t.onKeyDown=function(e){var n=Math.min,i=Math.max;if(t.searchResults.length){t.searchResultRange=t.searchResultRange?[i(0,t.searchResultRange[0]),n(t.searchResults.length-1,t.searchResultRange[1])]:[0,t.searchResults.length-1];var o=-1;t.highlightedItem&&(o=t.searchResults.indexOf(t.highlightedItem)),e.keyCode===v().keyCode.DOWN?-1===o||t.searchResultRange[1]<o+1?t.highlightMarker(t.searchResults[t.searchResultRange[0]],e):t.highlightMarker(t.searchResults[o+1],e):e.keyCode===v().keyCode.UP?[t.searchResultRange[0],-1].includes(o)?t.highlightMarker(t.searchResults[t.searchResultRange[1]],e):t.highlightMarker(t.searchResults[o-1],e):e.keyCode===v().keyCode.ENTER&&t.highlightedItem&&(e.stopPropagation(),t.dispatchEvent(new CustomEvent("change",{detail:{value:t.highlightedItem}}))&&(t.setPropertyValue("value",t.highlightedItem),t.highlightedItem.infoWindow?t.openMarker(t.highlightedItem,e):t.focusPlace(t.highlightedItem,e)))}},t.bootstrap=function(){if(t.resolvedConfiguration.startLocation)return t.initializeMap();if(t.resolvedConfiguration.startLocation=t.resolvedConfiguration.fallbackLocation,[null,void 0].includes(t.resolvedConfiguration.ipToLocationApplicationInterface.key))return t.initializeMap();var e=!1;return new Promise((function(n){var i=t.resolvedConfiguration.ipToLocationApplicationInterface,o=v().timeout(E(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return e=!0,i.next=3,t.initializeMap();case 3:n();case 4:case"end":return i.stop()}}),i)}))),i.timeoutInMilliseconds);g.$.ajax({cache:!0,dataType:"jsonp",url:v().stringFormat(i.url,i.protocol&&!i.protocol.endsWith(":")?i.protocol+":":i.protocol,i.key,t.resolvedConfiguration.ip||"")}).always((function(r){e||(o.clear(),e=!0,"number"==typeof r.latitude&&"number"==typeof r.longitude&&(!i.bounds||new t.self.maps.LatLngBounds(new t.self.maps.LatLng(i.bounds.southWest.latitude,i.bounds.southWest.longitude),new t.self.maps.LatLng(i.bounds.northEast.latitude,i.bounds.northEast.longitude)).contains(new t.self.maps.LatLng(r.latitude,r.longitude)))&&(t.resolvedConfiguration.startLocation=r),t.initializeMap().then(n))}))}))},t.defineGetterAndSetterInterface(),t.resolveConfiguration(),t}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_(e,t)}(n,e);var i=n.prototype;return i.attributeChangedCallback=function(t,n,i){e.prototype.attributeChangedCallback.call(this,t,n,i),this.resolveConfiguration()},i.disconnectedCallback=function(){var t,n,i,o;e.prototype.disconnectedCallback.call(this),this.root.removeEventListener("keydown",this.onKeyDown),null==(t=this.slots.input)||t.removeEventListener("click",this.onInputClick),null==(n=this.slots.input)||n.removeEventListener("focus",this.onInputFocus),null==(i=this.slots.input)||i.removeEventListener("keydown",this.onInputKeyDown),null==(o=this.slots.input)||o.removeEventListener("keyup",this.updateSearchResultsHandler)},i.setInternalPropertyValue=function(t,n){if(this.initialized||"default"!==t){if(this.loaded&&"value"===t)if(n!==(n=this.mapValue(n)))return void this.setPropertyValue(t,n);e.prototype.setInternalPropertyValue.call(this,t,n),this.initialized&&"disabled"===t&&(this.slots.disabledOverlay.style.display=n?"block":"none"),this.updateValueState()}else this.setPropertyValue("value",n)},i.render=function(){var t=E(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===n&&(n="unknown"),!this.initialized||"propertyChanged"!==n){t.next=3;break}return t.abrupt("return");case 3:return this.closeCurrentWindow(),this.initialized=!0,e.prototype.render.call(this,n),(0,g.$)(this.slots.input).css(this.resolvedConfiguration.input.hide),this.slots.disabledOverlay.style.display=this.disabled?"block":"none",t.next=10,this.loadMapEnvironmentIfNotAvailableAndInitializeMap();case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.resolveConfiguration=function(){if(this.resolvedConfiguration=v().extend(!0,v().copy(this.self.defaultConfiguration),this.configuration||{}),this.extendConfigurationByGivenURLParameter(),this.resolvedConfiguration.search=v().extend(!0,v().copy(this.self.defaultSearchConfiguration),this.resolvedConfiguration.search),this.resolvedConfiguration.debug,"function"==typeof this.resolvedConfiguration.transform)this.transform=this.resolvedConfiguration.transform;else if(this.resolvedConfiguration.transform){var e=v().stringCompile(this.resolvedConfiguration.transform,["store"]),t=e.error,n=e.templateFunction;t||(this.transform=n)}if("function"==typeof this.resolvedConfiguration.filter)this.filter=this.resolvedConfiguration.filter;else if(this.resolvedConfiguration.filter){var i=v().stringCompile(this.resolvedConfiguration.filter,["store"]),o=i.error,r=i.templateFunction;o||(this.filter=r)}},i.extendConfigurationByGivenURLParameter=function(e){e||(e=this.resolvedConfiguration.name);var t=v().stringGetURLParameter(e);if("string"==typeof t){var n=v().stringEvaluate(decodeURI(t));if(n.error)return;null!==n.result&&"object"==typeof n.result&&(this.urlConfiguration=v().mask(n.result,this.resolvedConfiguration.urlModelMask),v().extend(!0,this.resolvedConfiguration,this.urlConfiguration))}},i.loadMapEnvironmentIfNotAvailableAndInitializeMap=function(){var e,t,n=this,i=!0,o={reject:v().noop,resolve:v().noop,resolved:!1};"object"!=typeof this.self.applicationInterfaceLoad&&(i=!1,this.self.applicationInterfaceLoad=new Promise((function(e,t){o.resolve=function(){o.resolved=!0,e()},o.reject=t})));var r=this.self.applicationInterfaceLoad.then(this.bootstrap).then((function(){n.dispatchEvent(new CustomEvent("loaded"))&&n.onLoaded()}));if(null!=(e=g.globalContext.window)&&null!=(t=e.google)&&t.maps)this.self.maps=g.globalContext.window.google.maps,o.resolved||v().timeout((function(){return o.resolve()}));else if(!i){var s=this.resolvedConfiguration.applicationInterface.callbackName?this.resolvedConfiguration.applicationInterface.callbackName:v().determineUniqueScopeName(),a=function(){var e,t;o.resolved||(null!=(e=g.globalContext.window)&&null!=(t=e.google)&&t.maps?(n.self.maps=g.globalContext.window.google.maps,o.resolve()):o.reject(new Error("No google maps environment set.")))};g.globalContext[s]=a,g.$.getScript(v().stringFormat(this.resolvedConfiguration.applicationInterface.url,this.resolvedConfiguration.applicationInterface.key?"key="+this.resolvedConfiguration.applicationInterface.key+"&":"",(window===g.globalContext?"window":"global")+"."+s)).done(a).fail((function(e,t){o.reject(t)}))}return r},i.addMarker=function(e){if(this.filter(e)){v().extend(!0,e,this.resolvedConfiguration.additionalStoreProperties),e.streetAndStreetnumber||(e.streetAndStreetnumber=(e.street||"")+(e.streetnumber?", "+e.streetnumber:"")),e.zipCodeAndCity||(e.zipCodeAndCity=(e.zipCode||"")+(e.city?" "+e.city:"")),e.address||(e.address=(e.streetAndStreetnumber||"")+(e.zipCodeAndCity?", "+e.zipCodeAndCity:""));var t=this.createMarker(e);this.markerClusterer&&this.markerClusterer.addMarker(t)}},i.mapValue=function(e){if(![null,void 0].includes(e))for(var t,n,i=("object"==typeof e&&("id"in e||"data"in e&&"id"in e.data)?e.id||(null==(t=e.data)?void 0:t.id):e),o=R(this.items);!(n=o()).done;){var r,s=n.value;if(i===("object"==typeof i?s:null==(r=s.data)?void 0:r.id))return s.infoWindow&&!s.infoWindow.isOpen&&this.openMarker(s),s}return null},i.initializeMap=function(){var e=E(regeneratorRuntime.mark((function e(){var t,i,o,r,s,a,l,u,c,d,h,p,f,m,y,C,w,k,x,S,M=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=this.resolvedConfiguration.startLocation,this.resolvedConfiguration.map.center=new this.self.maps.LatLng(r.latitude,r.longitude),this.root.style.display="block",this.map=new this.self.maps.Map(this.root,this.resolvedConfiguration.map),(0,g.$)(this.root.firstElementChild).css(this.resolvedConfiguration.root.hide),this.resolvedConfiguration.limit&&this.self.maps.event.addListener(this.map,"dragend",(function(){var e=new n.maps.LatLngBounds(new n.maps.LatLng(M.resolvedConfiguration.limit.southWest.latitude,M.resolvedConfiguration.limit.southWest.longitude),new n.maps.LatLng(M.resolvedConfiguration.limit.northEast.latitude,M.resolvedConfiguration.limit.northEast.longitude)),t=M.map.getCenter();if(t&&!e.contains(t)){var i={latitude:t.lat(),longitude:t.lng()};t.lng()<e.getSouthWest().lng()&&(i.longitude=e.getSouthWest().lng()),t.lng()>e.getNorthEast().lng()&&(i.longitude=e.getNorthEast().lng()),t.lat()<e.getSouthWest().lat()&&(i.latitude=e.getSouthWest().lat()),t.lat()>e.getNorthEast().lat()&&(i.latitude=e.getNorthEast().lat()),M.map.panTo(new M.self.maps.LatLng(i.latitude,i.longitude))}})),this.resolvedConfiguration.marker.cluster&&(this.resetMarkerCluster=function(){for(var e,t,n=[],i=R(M.items);!(e=i()).done;)(t=e.value).marker&&(t.marker.setMap(null),delete t.marker),t.marker=new M.self.maps.Marker(M.createMarkerConfiguration(t)),M.attachMarkerEventListener(t),n.push(t.marker);M.markerClusterer&&M.markerClusterer.clearMarkers(),M.markerClusterer=new(b())(M.map,n,M.resolvedConfiguration.marker.cluster)},this.resetMarkerCluster()),this.applyBindings(this.slots.input,((t={})[v().stringLowerCase(this.self._name)||"instance"]=this,t.configuration=this.resolvedConfiguration,t.Tools=v(),t)),this.map.controls[this.self.maps.ControlPosition.TOP_LEFT].push(this.slots.input),s=0,a=[this.slots.disabledOverlay,this.slots.loadingOverlay,this.slots.link];s<a.length;s++)(l=a[s])&&(this.evaluateDomNodeTemplate(l,((u={})[v().stringLowerCase(this.self._name)||"instance"]=this,u.configuration=this.resolvedConfiguration,u.Tools=v(),u)),this.root.appendChild(l));if("number"==typeof this.resolvedConfiguration.search?this.initializeGenericSearch():(this.self.maps.event.addListener(this.map,"click",(function(){return M.closeSearchResults()})),this.self.maps.event.addListener(this.map,"dragstart",(function(){return M.closeSearchResults()})),this.initializeDataSourceSearch()),0<(c=this.markerClusterer&&this.resolvedConfiguration.marker.cluster.maxZoom||0)&&this.self.maps.event.addListener(this.map,"zoom_changed",(function(){("number"!=typeof M.map.getZoom()||M.map.getZoom()<=c)&&M.closeCurrentWindow()})),this.self.maps.mockup){e.next=16;break}return e.next=16,new Promise((function(e){M.self.maps.event.addListenerOnce(M.map,"idle",(function(){return e()}))}));case 16:if(!Array.isArray(this.resolvedConfiguration.stores)){e.next=20;break}for(d=R(this.resolvedConfiguration.stores);!(h=d()).done;)p=h.value,this.addMarker(this.transform(p));e.next=34;break;case 20:if("string"!=typeof this.resolvedConfiguration.stores){e.next=31;break}return e.next=23,g.globalContext.fetch(this.resolvedConfiguration.stores);case 23:return f=e.sent,e.next=26,f.text();case 26:for((m=e.sent).startsWith(this.resolvedConfiguration.securityResponsePrefix)&&(m=m.substring(this.resolvedConfiguration.securityResponsePrefix.length)),y=R(JSON.parse(m));!(C=y()).done;)w=C.value,this.addMarker(this.transform(w));e.next=34;break;case 31:for(k=new this.self.maps.LatLng(this.resolvedConfiguration.stores.southWest.latitude,this.resolvedConfiguration.stores.southWest.longitude),x=new this.self.maps.LatLng(this.resolvedConfiguration.stores.northEast.latitude,this.resolvedConfiguration.stores.northEast.longitude),S=0;S<this.resolvedConfiguration.stores.number;S++)this.addMarker(this.transform(L({latitude:k.lat()+(x.lat()-k.lat())*Math.random(),longitude:k.lng()+(x.lng()-k.lng())*Math.random()},this.resolvedConfiguration.additionalStoreProperties)));case 34:return this.loaded=!0,this.setPropertyValue("value",this.value),e.next=38,v().timeout(3e3);case 38:null!=(i=this.value)&&null!=(o=i.infoWindow)&&o.isOpen&&0!==this.resolvedConfiguration.infoWindow.additionalMoveToBottomInPixel&&this.map.panBy(0,-this.resolvedConfiguration.infoWindow.additionalMoveToBottomInPixel);case 39:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.initializeSearchResultsBox=function(){this.searchBoxInitialized=!0,this.searchResultsStyleProperties={};var e=(0,g.$)(this.slots.input).Tools("style");for(var t in e)this.resolvedConfiguration.search.stylePropertiesToDeriveFromInputField.includes(t)&&(this.searchResultsStyleProperties[t]=e[t]);var n=(0,g.$)(this.slots.input).outerHeight(!0);n&&(this.searchResultsStyleProperties.marginTop=n),(0,g.$)(this.slots.searchResults).css(this.searchResultsStyleProperties),this.slots.input.parentNode.insertBefore(this.slots.searchResults,this.slots.input.nextSibling)},i.initializeDataSourceSearch=function(){this.root.addEventListener("keydown",this.onKeyDown),this.slots.input.addEventListener("click",this.onInputClick),this.slots.input.addEventListener("focus",this.onInputFocus),this.slots.input.addEventListener("keydown",this.onInputKeyDown),this.slots.input.addEventListener("keyup",this.updateSearchResultsHandler),this.self.maps.event.addListener(this.map,"center_changed",this.onMapCenterChanged)},i.updateValueState=function(){this.valid=!([null,void 0].includes(this.value)&&this.required),this.invalid=!this.valid,this.loaded&&(this.dirty=!0,this.pristine=!this.dirty,this.dirty?(this.removeAttribute("pristine"),this.setAttribute("dirty","")):(this.removeAttribute("dirty"),this.setAttribute("pristine","")),this.disabled?this.setAttribute("disabled",""):this.removeAttribute("disabled"),this.valid?(this.removeAttribute("invalid"),this.setAttribute("valid","")):(this.removeAttribute("valid"),this.setAttribute("invalid","")))},i.handleGenericSearchResults=function(e){for(var t,n=this,i=[],o=this.resolvedConfiguration.search,r=this.map.getCenter(),s=1,a=function(){var e,a=t.value;s+=1;var l=0;if(r&&null!=(e=a.geometry)&&e.location&&(l=n.self.maps.geometry.spherical.computeDistanceBetween(r,a.geometry.location)),l>o.generic.maximalDistanceInMeter)return"break";if(o.generic.filter(a)){var u,c={data:L({},a,{address:a.formatted_address,distance:l,logoFilePath:a.icon?a.icon.replace(/^http:(\/\/)/,g.globalContext.location.protocol+"$1"):null}),foundWords:n.searchSegments.filter((function(e){var t;return(null==(t=a.formatted_address)?void 0:t.includes(e))||(a.name||"").includes(e)})),highlight:function(e,t){c.isHighlighted="stop"!==t},isHighlighted:!1,open:function(e){return n.focusPlace(c,e)},position:a.geometry&&null!==(u=a.geometry.location)&&void 0!==u?u:null};if(i.push(c),o.generic.number[1]<s)return"break"}},l=R(e.sort((function(e,t){var i,o,s=0,a=0;r&&(null!=(i=e.geometry)&&i.location&&(s=n.self.maps.geometry.spherical.computeDistanceBetween(r,e.geometry.location)),null!=(o=t.geometry)&&o.location&&(a=n.self.maps.geometry.spherical.computeDistanceBetween(r,t.geometry.location)));return s-a})));!(t=l()).done&&"break"!==a(););this.performLocalSearch(i)},i.performLocalSearch=function(e){var t,n=this;void 0===e&&(e=[]);for(var i,o=this.resolvedConfiguration.search,r=e.length,s=Object.prototype.hasOwnProperty.call(o,"properties")?o.properties:null,a=function(){var t=i.value,r=s||(t.data?Object.keys(t.data):[]);t.foundWords=[];for(var a,l,u=R(r);!(a=u()).done;){l=a.value;for(var c,d,h=R(n.searchSegments);!(c=h()).done;)d=c.value,!t.foundWords.includes(d)&&t.data&&t.data[l]&&"string"==typeof t.data[l]&&o.normalizer(t.data[l]).includes(d)&&(t.foundWords.push(d),1===t.foundWords.length&&(t.open=function(e){n.dispatchEvent(new CustomEvent("change",{detail:{value:t}}))&&(n.setPropertyValue("value",t),n.openMarker(t,e))},t.highlight=function(e,i){return n.highlightMarker(t,e,i)},"union"===o.resultAggregation&&e.push(t)),t.foundWords.length>=n.searchWords.length&&"cut"===o.resultAggregation&&e.push(t))}},l=R(this.items);!(i=l()).done;)a();o.generic.number&&e.length&&r>o.generic.number[0]&&e.length>o.generic.number[1]&&e.splice(o.generic.number[0],r-o.generic.number[0]),e.sort((function(e,t){if(o.generic.prefer){if(!e.infoWindow&&t.infoWindow)return-1;if(!t.infoWindow&&e.infoWindow)return 1}if(e.foundWords.length<t.foundWords.length)return 1;if(t.foundWords.length<e.foundWords.length)return-1;var i=n.map.getCenter(),r=0,s=0;return i&&(e.position&&(r=n.self.maps.geometry.spherical.computeDistanceBetween(i,e.position)),t.position&&(s=n.self.maps.geometry.spherical.computeDistanceBetween(i,t.position))),r-s}));var u=!1;o.maximumNumberOfResults<e.length&&(u=!0,e.splice(o.maximumNumberOfResults,e.length)),this.searchResults=e.slice(),this.dispatchEvent(new CustomEvent("addSearchResults",{detail:{results:e}}))&&this.evaluateDomNodeTemplate(this.slots.searchResults,((t={})[v().stringLowerCase(this.self._name)||"instance"]=this,t.configuration=this.resolvedConfiguration,t.limitReached=u,t.loading=!1,t.results=this.searchResults,t.searchSegments=this.searchSegments,t.searchText=this.searchText,t.searchWords=this.searchWords,t.Tools=v(),t))},i.openSearchResults=function(e){var t;if(e&&e.stopPropagation(),this.slots.searchResults&&(null==(t=this.slots.searchResults.classList)||!t.contains("store-locator__search-results--open"))&&this.dispatchEvent(new CustomEvent("openSearchResults",{detail:{event:e,searchResults:this.searchResults,searchSegments:this.searchSegments,searchText:this.searchText,searchWords:this.searchWords}}))){for(var n,i=0,o=Object.entries(this.searchResultsStyleProperties);i<o.length;i++){var r=o[i],s=r[0],a=r[1];this.slots.searchResults.style[s]=""+a}null==(n=this.slots.searchResults.classList)||n.add("store-locator__search-results--open")}},i.closeSearchResults=function(e){var t,n;if(e&&e.stopPropagation(),null!=(t=this.slots.searchResults)&&null!=(n=t.classList)&&n.contains("store-locator__search-results--open")&&this.dispatchEvent(new CustomEvent("closeSearchResults"))){for(var i,o,r=0,s=Object.keys(this.searchResultsStyleProperties);r<s.length;r++)o=s[r],this.slots.searchResults.style[o]="";null==(i=this.slots.searchResults.classList)||i.remove("store-locator__search-results--open")}},i.initializeGenericSearch=function(){var e=this,n=new this.self.maps.places.SearchBox(this.slots.input,{bounds:new this.self.maps.LatLngBounds(new this.self.maps.LatLng(this.resolvedConfiguration.limit.southWest.latitude,this.resolvedConfiguration.limit.southWest.longitude),new this.self.maps.LatLng(this.resolvedConfiguration.limit.northEast.latitude,this.resolvedConfiguration.limit.northEast.longitude))});this.self.maps.event.addListener(this.map,"bounds_changed",(function(){var t=e.map.getBounds();t&&n.setBounds(t)})),this.self.maps.event.addListener(n,"places_changed",(function(){var i=n.getPlaces();Array.isArray(i)&&e.ensurePlaceLocations(i).then((function(n){var i=e.determineBestSearchResult(n);if(i){for(var o,r,s,a=t,l=R(e.items);!(s=l()).done;){var u,c=s.value,d=0;null!=(u=i.geometry)&&u.location&&c.position&&(d=e.self.maps.geometry.spherical.computeDistanceBetween(i.geometry.location,c.position)),d<a&&(a=d,r=c)}if(r&&a<=e.resolvedConfiguration.search)return e.resolvedConfiguration.successfulSearchZoomLevel&&e.map.setZoom(e.resolvedConfiguration.successfulSearchZoomLevel),void e.openMarker(r);e.closeCurrentWindow(),null!=(o=i.geometry)&&o.location&&e.map.setCenter(i.geometry.location),e.resolvedConfiguration.successfulSearchZoomLevel&&e.map.setZoom(e.resolvedConfiguration.successfulSearchZoomLevel)}})).catch((function(){}))}))},i.closeCurrentWindow=function(){this.openWindow&&(this.openWindow.isOpen=!1,this.openWindow.close&&this.openWindow.close())},i.ensurePlaceLocations=function(e){var t=this,n=0,i=new this.self.maps.Geocoder;return new Promise((function(o){for(var r,s=function(){var s,a=r.value;null!=(s=a.geometry)&&s.location||(n+=1,i.geocode({address:a.name},(function(i,r){n-=1,i&&r===t.self.maps.GeocoderStatus.OK?a.geometry=i[0].geometry:delete e[e.indexOf(a)],0===n&&o(e)})))},a=R(e);!(r=a()).done;)s();0===n&&o(e)}))},i.determineBestSearchResult=function(e){var n=this.map.getCenter(),i=null;if(n&&e.length)for(var o,r=t,s=R(e);!(o=s()).done;){var a,l=o.value,u=0;null!=(a=l.geometry)&&a.location&&(u=this.self.maps.geometry.spherical.computeDistanceBetween(l.geometry.location,n)),u<r&&(i=l,r=u)}return i},i.onLoaded=function(){var e=E(regeneratorRuntime.mark((function e(){var t,n,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=(0,g.$)(this.slots.loadingOverlay)).animate.apply(t,this.resolvedConfiguration.loadingHideAnimation).promise().then((function(){o.slots.loadingOverlay.style.display="none"})),(n=(0,g.$)(this.root.firstElementChild)).animate.apply(n,this.resolvedConfiguration.root.showAnimation),e.next=4,v().timeout(this.resolvedConfiguration.showInputAfterLoadedDelayInMilliseconds);case 4:(i=(0,g.$)(this.slots.input)).animate.apply(i,this.resolvedConfiguration.input.showAnimation);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.createMarker=function(e){var t=0;if(e&&e.latitude&&e.longitude){for(;this.seenLocations.includes(e.latitude+"-"+e.longitude);)t%2?e.latitude+=this.resolvedConfiguration.distanceToMoveByDuplicatedEntries:e.longitude+=this.resolvedConfiguration.distanceToMoveByDuplicatedEntries,t+=1;this.seenLocations.push(e.latitude+"-"+e.longitude)}var n={data:e||null,foundWords:[],highlight:v().noop,isHighlighted:!1,open:v().noop,position:e&&e.latitude&&e.longitude?new this.self.maps.LatLng(e.latitude,e.longitude):null};if(null!=e&&e.markerIconFileName||this.resolvedConfiguration.defaultMarkerIconFileName){if(n.icon=this.resolvedConfiguration.marker.icon?v().copy(this.resolvedConfiguration.marker.icon):{},n.icon.scaledSize){var i=n.icon.scaledSize;n.icon.scaledSize=new this.self.maps.Size(i.width,i.height,i.unit,i.unit)}if(n.icon.size){var o=n.icon.size;n.icon.size=new this.self.maps.Size(o.width,o.height,o.unit,o.unit)}n.icon.url=this.resolvedConfiguration.iconPath,n.icon.url+=null!=e&&e.markerIconFileName?e.markerIconFileName:this.resolvedConfiguration.defaultMarkerIconFileName}return null!=e&&e.title&&(n.title=e.title),n.infoWindow=new this.self.maps.InfoWindow({content:""}),n.infoWindow.isOpen=!1,n.marker=new this.self.maps.Marker(this.createMarkerConfiguration(n)),this.attachMarkerEventListener(n),this.items.push(n),n.marker},i.createMarkerConfiguration=function(e){return{clickable:!0,crossOnDrag:!0,draggable:!1,icon:e.icon,label:e.title,map:this.map,opacity:.9,optimized:!0,position:e.position,title:e.title,visible:!0,zIndex:1}},i.attachMarkerEventListener=function(e){var t=this;this.self.maps.event.addListener(e.infoWindow,"closeclick",(function(n){t.dispatchEvent(new CustomEvent("infoWindowClose",{detail:{event:n,item:e}}))&&t.dispatchEvent(new CustomEvent("change",{detail:{value:null}}))&&(e.infoWindow.isOpen=!1,t.setPropertyValue("value",null),t.dispatchEvent(new CustomEvent("infoWindowClosed",{detail:{event:n,item:e}})))})),this.self.maps.event.addListener(e.marker,"click",(function(n){t.dispatchEvent(new CustomEvent("change",{detail:{value:e}}))&&(t.setPropertyValue("value",e),t.openMarker(e,n))}))},i.openMarker=function(e,t){if(t&&!t.stopPropagation&&(t=void 0),this.dispatchEvent(new CustomEvent("infoWindowOpen",{detail:{event:t,item:e}}))){var n,i,o,r;if(this.highlightMarker(e,t,"stop"),null!=(n=this.resolvedConfiguration.marker.cluster)&&n.maxZoom&&(null!==(i=this.map.getZoom())&&void 0!==i?i:0)<=this.resolvedConfiguration.marker.cluster.maxZoom&&this.map.setZoom(this.resolvedConfiguration.marker.cluster.maxZoom+1),this.closeSearchResults(t),null!=(o=this.openWindow)&&o.isOpen&&this.openWindow===e.infoWindow)return;var s=e.infoWindow;e.refreshSize=function(){return s.setContent(s.getContent())},this.evaluateDomNodeTemplate(this.slots.infoWindow,L({},e,((r={})[v().stringLowerCase(this.self._name)||"instance"]=this,r.configuration=this.resolvedConfiguration,r.item=e,r.instance=this,r.Tools=v(),r))),s.setContent(this.slots.infoWindow.outerHTML),this.closeCurrentWindow(),s.isOpen=!0,this.openWindow=s,s.open(this.map,e.marker),this.map.panTo(e.position),this.map.panBy(0,-this.resolvedConfiguration.infoWindow.additionalMoveToBottomInPixel),this.dispatchEvent(new CustomEvent("infoWindowOpened",{detail:{event:t,item:e}}))}},i.focusPlace=function(e,t){t&&t.stopPropagation(),this.closeSearchResults(t),this.closeCurrentWindow(),this.map.setCenter(e.position),this.map.setZoom(this.resolvedConfiguration.successfulSearchZoomLevel)},i.highlightMarker=function(e,t,n){if(void 0===n&&(n="bounce"),t&&t.stopPropagation(),this.highlightedItem&&(this.highlightedItem.marker&&this.highlightedItem.marker.setAnimation(null),this.highlightedItem.isHighlighted=!1,this.highlightedItem=null),e.marker)if("stop"===n)e.marker.setAnimation(null);else{var i,o;null!=(i=this.resolvedConfiguration.marker.cluster)&&i.maxZoom&&(null!==(o=this.map.getZoom())&&void 0!==o?o:0)<=this.resolvedConfiguration.marker.cluster.maxZoom&&e.position&&this.map.getBounds().contains(e.position)&&(this.map.setCenter(e.position),this.map.setZoom(this.resolvedConfiguration.marker.cluster.maxZoom+1)),e!==this.highlightedItem&&e.marker&&(e.marker.setAnimation(this.self.maps.Animation[n.toUpperCase()]),this.highlightedItem=e,e.isHighlighted=!0),this.dispatchEvent(new CustomEvent("markerHighlighted",{detail:{event:t,item:e}}))}},function(e,t,n){t&&P(e.prototype,t),n&&P(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"updateSearchResultsHandler",get:function(){var e=this,t=new this.self.maps.places.PlacesService(this.map),n=this.resolvedConfiguration.search;return v().debounce(E(regeneratorRuntime.mark((function i(o){var r,s,a;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=regeneratorRuntime.keys(v().keyCode);case 1:if((i.t1=i.t0()).done){i.next=7;break}if(r=i.t1.value,!o||o.keyCode!==v().keyCode[r]||["BACKSPACE","COMMA","DELETE","NUMPAD_ADD","NUMPAD_DECIMAL","NUMPAD_DIVIDE","NUMPAD_MULTIPLY","NUMPAD_SUBTRACT","PERIOD"].includes(r)){i.next=5;break}return i.abrupt("return");case 5:i.next=1;break;case 7:if(s=n.normalizer(e.slots.input.value),e.searchText!==s||e.searchResultsDirty){i.next=10;break}return i.abrupt("return");case 10:return i.next=12,e.lock.acquire(e.self._name+"Search");case 12:if(e.searchResultsDirty=!1,e.searchBoxInitialized||e.initializeSearchResultsBox(),s&&!(s.length<n.generic.minimumNumberOfSymbols)){i.next=18;break}return e.searchResults.length&&(e.searchResults=[],e.searchText="",e.dispatchEvent(new CustomEvent("removeSearchResults"))&&e.closeSearchResults()),e.lock.release(e.self._name+"Search"),i.abrupt("return");case 18:e.searchText=s,e.searchWords=e.searchText.split(" "),e.searchSegments=[].concat(e.searchWords),e.searchSegments.includes(e.searchText)||e.searchSegments.push(e.searchText),e.slots.searchResults&&e.dispatchEvent(new CustomEvent("loadSearchResults"))&&(e.openSearchResults(),e.evaluateDomNodeTemplate(e.slots.searchResults,((a={})[v().stringLowerCase(e.self._name)||"instance"]=e,a.configuration=e.resolvedConfiguration,a.limitReached=!1,a.loading=!0,a.results=[],a.searchSegments=e.searchSegments,a.searchText=e.searchText,a.searchWords=e.searchWords,a.Tools=v(),a))),n.generic.number?t.textSearch(L({},n.generic.retrieveOptions,{location:e.map.getCenter(),query:e.searchText}),(function(t){t&&e.handleGenericSearchResults(t),e.lock.release(e.self._name+"Search")})):(e.performLocalSearch(),e.lock.release(e.self._name+"Search"));case 24:case"end":return i.stop()}}),i)}))),n.generic.searchDebounceTimeInMilliseconds)}}]),n}(S()),m.applicationInterfaceLoad=void 0,m.cloneSlots=!0,m.content='\n        <slot name="loadingOverlay">\n            <div class="store-locator__loading-overlay">\n                <span class="store-locator__loading-overlay__content">\n                    Loading...\n                </span>\n            </div>\n        </slot>\n\n        <slot name="disabledOverlay">\n            <div class="store-locator__disabled-overlay"></div>\n        </slot>\n\n        <slot name="input">\n            <input class="store-locator__input" style="display:none" />\n        </slot>\n\n        <slot name="searchResults"><div class="store-locator__search-results">\n            <textarea style="display:none">\\${\n\nloading ?\n    (\n        "<div class=\\\\"" +\n        "store-locator__search-results store-locator__search-results" +\n        "--loading" +\n        "\\\\">loading...</div>"\n    ) :\n    results.length ?\n        results.map(function(result) {\n            return ("<ul>" +\n                "<li>" +\n                    Object.keys(result.data)\n                        .filter(function(name) {\n                            return ["number", "string"]\n                                .includes(typeof result.data[name])\n                        })\n                        .map(function(name) {\n                            return (\n                                name +\n                                ": " +\n                                Tools.stringMark(\n                                    result.data[name],\n                                    searchWords,\n                                    configuration.search.normalizer\n                                )\n                            )\n                        })\n                        .join("</li><li>") +\n                "</li>" +\n            "</ul>")\n        })\n        .join("") :\n        (\n            "<div class=\\\\"" +\n            "store-locator__search-results store-locator__search-results" +\n            "--no-results" +\n            "\\\\">No results found</div>"\n        )\n            }</textarea>\n        </div></slot>\n\n        <slot name="infoWindow"><ul class="store-locator__info-window">\n            <textarea style="display:none">\n                <li>\n                    \\${Object.keys(item.data)\n                        .filter(function(name) {\n                            return ["number", "string"]\n                                .includes(typeof item.data[name])\n                        })\n                        .map(function(name) {\n                            return name + ": " + item.data[name]\n                        })\n                        .join("</li><li>")\n                    }\n                </li>\n            </textarea>\n        </ul></slot>\n    ',m.defaultConfiguration={additionalStoreProperties:{},defaultMarkerIconFileName:null,filter:null,iconPath:"",infoWindow:{additionalMoveToBottomInPixel:80},transform:null,stores:{generateProperties:function(e){return e},northEast:{latitude:85,longitude:180},number:100,southWest:{latitude:-85,longitude:-180}},applicationInterface:{callbackName:null,key:null,url:"\n                https://maps.googleapis.com/maps/api/js ?\n                    {1}\n                    v=3 &\n                    sensor=false &\n                    libraries=places,geometry &\n                    callback={2}\n            ".replace(/[ \n]+/g,"")},debug:!1,distanceToMoveByDuplicatedEntries:1e-4,fallbackLocation:{latitude:51.124213,longitude:10.147705},ip:"check",ipToLocationApplicationInterface:{bounds:{northEast:{latitude:85,longitude:180},southWest:{latitude:-85,longitude:-180}},key:null,protocol:"https",timeoutInMilliseconds:1e3,url:"{1}//api.ipstack.com/{3}?access_key={2}&fields=latitude,longitude"},startLocation:null,input:{hide:{display:"block",opacity:0},showAnimation:[{opacity:1},{duration:"fast"}]},loadingHideAnimation:[{opacity:0},{duration:"fast"}],showInputAfterLoadedDelayInMilliseconds:500,root:{hide:{display:"block",opacity:0},showAnimation:[{opacity:1},{duration:"fast"}]},limit:{northEast:{latitude:85,longitude:180},southWest:{latitude:-85,longitude:-180}},map:{disableDefaultUI:!0,maxZoom:9999,minZoom:0,streetViewControl:!0,zoom:3,zoomControl:!0},marker:{cluster:{gridSize:100,imagePath:"https://raw.githubusercontent.com/googlemaps/js-markerclustererplus/main/images/m",maxZoom:11},icon:{scaledSize:{height:49,unit:"px",width:44},size:{height:49,unit:"px",width:44}}},name:"storeLocator",search:50,successfulSearchZoomLevel:12,securityResponsePrefix:")]}',",urlModelMask:{exclude:!1,include:{model:!1,reCaptcha:{secret:!0,skip:!0},tag:!0,tags:!0}}},m.defaultSearchConfiguration={generic:{filter:function(e){return/(?:^| )(?:Deutschland|Germany)( |$)/i.test(e.formatted_address)},maximalDistanceInMeter:1e6,minimumNumberOfSymbols:3,number:[2,5],prefer:!0,retrieveOptions:{radius:5e4,query:""},searchDebounceTimeInMilliseconds:1e3},maximumNumberOfResults:50,normalizer:function(e){return(""+e).toLowerCase().replace(/[-_]+/g,"").replace(/ß/g,"ss").replace(/(^| )str\./g,"$1strasse").replace(/[& ]+/g," ")},properties:["eMailAddress","eMail","email","formattedAddress","formatted_address","address","name","street","streetAndStreetnumber","zip","zipCode","postalCode"],resultAggregation:"cut",stylePropertiesToDeriveFromInputField:["backgroundColor","left","maxWidth","minWidth","position","paddingBottom","paddingLeft","paddingRight","paddingTop","right","top","width"]},m.maps=void 0,m.renderSlots=!!(g.globalContext.window&&g.globalContext.window.google&&g.globalContext.window.google.maps&&g.globalContext.window.google.maps.mockup),m.renderUnsafe=!0,m._name="StoreLocator",u=z((s=m).prototype,"configuration",[e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=z(s.prototype,"name",[t],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"storeLocator"}}),d=z(s.prototype,"default",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=z(s.prototype,"disabled",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=z(s.prototype,"required",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=z(s.prototype,"value",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),s),T={component:O,register:function(e){return void 0===e&&(e="store-locator"),customElements.define(e,O)}};l.default=T}(),l}()}));